<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SWA Windapp – Schokkerhaven</title>

  <!-- TailwindCSS (één bestand, werkt direct op GitHub Pages) -->
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>

  <!-- Kleuren & lettertypen -->
  <style>
    :root{
      --brand:#E71C1F;          /* fel rood voor accenten */
      --brand-dark:#000000;     /* zwart */
      --bg:#f4f4f4;             /* zachte achtergrond */
      --font-head:"Inter",system-ui,Helvetica,Arial,sans-serif;
      --font-body:"Inter",system-ui,Helvetica,Arial,sans-serif;
    }
    body{font-family:var(--font-body);background:var(--bg);}
  </style>
</head>

<body class="min-h-screen flex flex-col items-center p-4">

  <!-- HEADER --------------------------------------------------------- -->
  <header class="w-full max-w-md text-center mb-6">
    <img src="Logo.png" alt="SWA-logo"
         class="mx-auto mb-2" style="max-height:110px;width:auto;object-fit:contain">
    <h1 class="text-3xl font-bold tracking-tight" style="color:var(--brand)">
      SWA Windapp
    </h1>
    <p class="text-sm text-slate-600">
      Wind • Schokkerhaven – live + 8 u forecast
    </p>
  </header>

  <!-- ACTUELE WIND --------------------------------------------------- -->
  <section id="current"
           class="w-full max-w-md bg-white rounded-2xl shadow p-4 mb-4 flex flex-col items-center gap-1">
    <h2 class="font-semibold" style="color:var(--brand)">
      Huidig&nbsp;<span id="currTime" class="text-xs text-slate-500"></span>
    </h2>
    <p class="text-2xl font-bold">
      <span id="currSpeed">–</span>&nbsp;kn
    </p>
    <p id="currDir"
       class="uppercase tracking-widest text-sm text-slate-600">–</p>
  </section>

  <!-- FORECAST ------------------------------------------------------- -->
  <section class="w-full max-w-md">
    <!-- tabelkop -->
    <div class="grid grid-cols-4 gap-2 text-center text-xs font-semibold text-white">
      <div class="py-1 rounded-t-lg" style="background:var(--brand-dark)">Tijd</div>
      <div class="py-1 rounded-t-lg" style="background:var(--brand-dark)">Weer</div>
      <div id="h2label"
           class="py-1 rounded-t-lg" style="background:var(--brand-dark)">ICON-D2</div>
      <div id="h3label"
           class="py-1 rounded-t-lg" style="background:var(--brand-dark)">HARM-NL</div>
    </div>

    <!-- rijen worden met JS gevuld -->
    <div id="forecastRows"
         class="grid grid-cols-4 gap-2 text-center bg-white rounded-b-2xl shadow"></div>
  </section>

  <!-- foutmelding ----------------------------------------------------- -->
  <p id="err" class="hidden mt-6 text-sm text-red-600 text-center max-w-md"></p>

  <!-- FOOTER ---------------------------------------------------------- -->
  <footer class="mt-6 text-[10px] text-slate-500">
    Weerdata: <a href="https://open-meteo.com" class="underline" style="color:var(--brand)">Open-Meteo.com</a>
  </footer>

  <!-- JAVASCRIPT ------------------------------------------------------ -->
  <script>
  (()=>{
    /* LOCATIE – Schokkerhaven */
    const lat  = 52.613;
    const lon  = 5.747;
    const tz   = 'Europe/Amsterdam';
    const hrs  = 8;                      // forecast-venster 8 u

    /* MODELLEN */
    const model1 = 'icon_d2',  m1Label = 'ICON-D2';
    const model2 = 'knmi_harmonie_arome_netherlands', m2Label = 'HARM-NL';
    h2label.textContent = m1Label;
    h3label.textContent = m2Label;

    /* HULPFUNCTIES */
    const showErr = m=>{ err.textContent = m; err.classList.remove('hidden'); };

    const deg2card = d=>{
      const dirs = ["N","NNE","NE","ENE","E","ESE","SE","SSE",
                    "S","SSW","SW","WSW","W","WNW","NW","NNW"];
      return dirs[Math.round(d/22.5)%16];
    };
    const tOnly = iso=>iso.slice(11,16);          // "2025-07-08T17:00" → "17:00"

    const wmo2emoji = code=>{
      if([0].includes(code)) return "☀️";
      if([1].includes(code)) return "🌤️";
      if([2].includes(code)) return "⛅";
      if([3].includes(code)) return "☁️";
      if([45,48].includes(code)) return "🌫️";
      if([51,53,55,56,57,61,63,65,66,67,80,81,82].includes(code)) return "🌧️";
      if([71,73,75,77,85,86].includes(code)) return "❄️";
      if([95,96,99].includes(code)) return "⛈️";
      return "❓";
    };

    /* ACTUELE WIND --------------------------------------------------- */
    fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&wind_speed_unit=kn&timezone=${tz}`)
      .then(r=>{ if(!r.ok) throw new Error('Actuele data niet beschikbaar'); return r.json(); })
      .then(d=>{
        const c = d.current_weather;
        currSpeed.textContent = Math.round(c.windspeed);
        currDir.textContent   = deg2card(c.winddirection);
        currTime.textContent  = `(${tOnly(c.time)})`;
      })
      .catch(showErr);

    /* API-CALL HELPERS ----------------------------------------------- */
    const fetchWx = ()=> fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=weathercode&forecast_hours=${hrs}&timezone=${tz}`
    ).then(r=>{ if(!r.ok) throw new Error('Weericoon-data niet beschikbaar'); return r.json(); });

    const fetchFc = m=> fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}`+
      `&hourly=wind_speed_10m,wind_direction_10m,wind_gusts_10m`+
      `&wind_speed_unit=kn&forecast_hours=${hrs}&models=${m}&timezone=${tz}`
    ).then(r=>{ if(!r.ok) throw new Error('Forecast-data niet beschikbaar'); return r.json(); });

    /* DATA OPHALEN ---------------------------------------------------- */
    Promise.all([ fetchWx(), fetchFc(model1), fetchFc(model2) ])
      .then(([wx, f1, f2])=>{
        const times = f1.hourly.time;
        const rows  = forecastRows;

        for(let i=0;i<times.length;i++){
          /* tijd */
          const d0 = document.createElement('div');
          d0.className = 'py-1 border-b'; d0.textContent = tOnly(times[i]);
          rows.appendChild(d0);

          /* icoon */
          const d1 = document.createElement('div');
          d1.className = 'py-1 border-b'; d1.textContent = wmo2emoji(wx.hourly.weathercode[i]);
          rows.appendChild(d1);

          /* twee modellen */
          [f1,f2].forEach(f=>{
            const cell = document.createElement('div');
            cell.className = 'py-1 border-b leading-tight';

            const v   = Math.round(f.hourly.wind_speed_10m[i]);
            const g   = f.hourly.wind_gusts_10m ? Math.round(f.hourly.wind_gusts_10m[i]) : '–';
            const dir = deg2card(f.hourly.wind_direction_10m[i]);

            cell.innerHTML =
              `<span class="font-medium">${v}</span>`+
              `<span class="text-[10px] ml-1 text-slate-500">${dir}</span>`+
              `<br>`+
              `<span class="text-xs font-semibold" style="color:var(--brand)">${g}</span>`;
            rows.appendChild(cell);
          });
        }
      })
      .catch(showErr);
  })();
  </script>
</body>
</html>
